@SHOW_SHOP
TRYCALL COM461_PUNISHMENT_END
TRYCALL 追加パッチVerUP

;奴隷購入ページフラグ
TFLAG:100 = 0
DRAWLINE
PRINTFORML {DAY}日目(%GET_DAY()%)
PRINTFORML (所持金:${MONEY})
PRINT 体力:
BAR BASE:MASTER:0,MAXBASE:MASTER:0,16
PRINTFORM ({BASE:MASTER:0,4}/{MAXBASE:MASTER:0,4}) 
PRINT 気力:
BAR BASE:MASTER:1,MAXBASE:MASTER:1,16
PRINTFORM ({BASE:MASTER:1,4}/{MAXBASE:MASTER:1,4})
PRINTL

PRINTL [100] - 起床
PRINTL [101] - 能力表示
SIF STRLENS(SAVESTR:10) > 1
	PRINTL [102] - コレクション
PRINTL [103] - 通信販売
PRINTL [104] - 設定
PRINTL [200] - SAVE
PRINTL [300] - LOAD
PRINTL [400] - OPTION
TRYCALL 妊娠パッチDEBUG88

@USERSHOP

TRYCALL 妊娠パッチDEBUG88COM

IF RESULT == 100
	BEGIN TRAIN
	RETURN 1
ELSEIF RESULT == 101
	CALL SHOW_CHARADATA
ELSEIF RESULT == 102 && STRLENS(SAVESTR:10) > 1
	CALL SHOW_COLLECTION
ELSEIF RESULT == 103
	CALL ITEM_BUY
ELSEIF RESULT == 104
	CALL SCHEDULE
ELSEIF RESULT == 200
	SAVEGAME
ELSEIF RESULT == 300
	LOADGAME
ELSEIF RESULT == 400
	CALL OPTION
ENDIF


@SCHEDULE
PRINTL [0] - 起床時間設定
SIF FLAG:陥落人数
	PRINTL [1] - 私室設定
PRINTL [100] - 戻る
INPUT
IF RESULT == 100
	RETURN 0
ENDIF
IF RESULT == 0
	PRINTL 何時に起床しますか?(0〜23を入力してください)
	$INPUT_LOOP
	INPUT
	SIF RESULT < 0 || RESULT > 23
		GOTO INPUT_LOOP
	CFLAG:MASTER:312 = RESULT * 60
ENDIF
IF RESULT == 1 && FLAG:陥落人数
	PRINTL [0] - 私室変更
	SIF CFLAG:MASTER:開始位置 != 73
		PRINTL [1] - 引っ越し
	PRINTL [100] - やっぱやめる
	$INPUT_LOOP2
	INPUT
	IF RESULT == 100
		RETURN 0
ELSEIF RESULT == 0
	PRINTL 寝起きする部屋を変えることが出来ます
	PRINTL [0] - 自分の部屋
	FOR LOCAL,1,CHARANUM
		SIF TALENT:LOCAL:恋慕
			PRINTFORML [{LOCAL}] - %CALLNAME:LOCAL%の部屋
	NEXT
	$INPUT_LOOP3
	INPUT
	
	IF RESULT < 0 || RESULT >= CHARANUM
		CLEARLINE 1
		GOTO INPUT_LOOP3
	ELSEIF RESULT == 0
		CFLAG:MASTER:開始位置 = 15
	ELSEIF TALENT:RESULT:恋慕
		CFLAG:MASTER:開始位置 = CFLAG:RESULT:311
	ELSE
		CLEARLINE 1
		GOTO INPUT_LOOP3
	ENDIF
	PRINTW 変更は翌日から反映されます
	ENDIF
ELSEIF RESULT == 1
	PRINTL 空き家に引越すことができます
	PRINTL 誰と引っ越しますか？
	PRINTL [0] - 一人で
	FOR LOCAL,1,CHARANUM
		SIF TALENT:LOCAL;恋慕
			PRINTFORML [{LOCAL}] - %CALLNAME:LOCAL%と
	NEXT
	$INPUT_LOOP4
	INPUT
	
	IF RESULT < 0 || RESULT >= CHARANUM
		CLEARLINE 1
		GOTO INPUT_LOOP4
	ELSEIF RESULT == 0
		CFLAG:MASTER:開始位置 = 73
	ELSEIF TALENT:RESULT:恋慕
		CFLAG:MASTER:開始位置 = 73
		CFLAG:RESULT:311 = 73
	ELSE
		CLEARLINE 1
		GOTO INPUT_LOOP4
	ENDIF
	PRINTW 変更は翌日から反映されます
		
ENDIF

RETURN 1

