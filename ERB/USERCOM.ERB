;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SHOW_USERCOM
	TFLAG:100 = !TFLAG:101
	VARSET LOCAL
	IF TCVAR:MASTER:112 == 1
		LOCAL:1 = MASTER_POSE(6,1,1)
	ELSEIF TCVAR:MASTER:112 == 2
		LOCAL:1 = MASTER_POSE(7,1,1)
	ENDIF
	FOR LOCAL,0,700
		RESULT = 0
		SIF LOCAL == 200 && TFLAG:102 == 2
			PRINTL
		SIF LOCAL == 350 && TFLAG:102 != 2
			PRINTL
		SIF LOCAL == 400 && TFLAG:102 != 2
			PRINTL
		TRYCALLFORM COM_ABLE{LOCAL}
		IF RESULT
			IF (LOCAL == 42 && TEQUIP:11) || (LOCAL == 43 && TEQUIP:12) || (LOCAL == 44 && TEQUIP:13) || (LOCAL == 45 && TEQUIP:14) || (LOCAL == 46 && TEQUIP:15) || (LOCAL == 47 && TEQUIP:16) || (LOCAL == 48 && TEQUIP:17)
				PRINTFORMC %TRAINNAME:LOCAL%解除[{LOCAL,3}]
			ELSEIF LOCAL == 81 && LOCAL:1
				PRINTFORMC お掃除フェラ[{LOCAL,3}]
			ELSEIF LOCAL == 10 && TALENT:TARGET:母乳体質
				PRINTFORMC 母乳飲み[{LOCAL,3}]
			ELSEIF LOCAL == 60 && !BEDROOM(CFLAG:PLAYER:現在位置)
				PRINTFORMC 対面立位[{LOCAL,3}]
			ELSEIF LOCAL == 61 && !BEDROOM(CFLAG:PLAYER:現在位置)
				PRINTFORMC 背面立位[{LOCAL,3}]
			ELSEIF LOCAL == 62 && !BEDROOM(CFLAG:PLAYER:現在位置)
				PRINTFORMC 対面立位アナル[{LOCAL,3}]
			ELSEIF LOCAL == 63 && !BEDROOM(CFLAG:PLAYER:現在位置)
				PRINTFORMC 背面立位アナル[{LOCAL,3}]
			ELSEIF LOCAL == 200
				IF EQUIP:上半身上着１
					LOCALS = %CLOTHNAME(12,EQUIP:上半身上着１)%
				ELSEIF EQUIP:上半身上着２
					LOCALS = %CLOTHNAME(13,EQUIP:上半身上着２)%
				ELSEIF EQUIP:ボディースーツ
					LOCALS = %CLOTHNAME(14,EQUIP:ボディースーツ)%
				ELSEIF EQUIP:ワンピース
					LOCALS = %CLOTHNAME(15,EQUIP:ワンピース)%
				ELSEIF EQUIP:着物
					LOCALS = %CLOTHNAME(16,EQUIP:着物)%
				ELSEIF EQUIP:レオタード
					LOCALS = %CLOTHNAME(17,EQUIP:レオタード)%
				ENDIF
				IF CFLAG:うふふ == 3
					PRINTFORMC %LOCALS%を脱ぐ[{LOCAL,3}]
				ELSE
					PRINTFORMC %LOCALS%を脱がす[{LOCAL,3}]
				ENDIF
			ELSEIF LOCAL == 201
				IF EQUIP:下半身上着１
					LOCALS = %CLOTHNAME(7,EQUIP:下半身上着１)%
				ELSEIF EQUIP:下半身上着２
					LOCALS = %CLOTHNAME(8,EQUIP:下半身上着２)%
				ELSEIF EQUIP:スカート
					LOCALS = スカート
				ENDIF
				IF CFLAG:うふふ == 3
					PRINTFORMC %LOCALS%を脱ぐ[{LOCAL,3}]
				ELSE
					PRINTFORMC %LOCALS%を脱がす[{LOCAL,3}]
				ENDIF
			ELSEIF LOCAL == 202
				IF EQUIP:上半身下着１ == 2
					PRINTFORMC サラシを外す[{LOCAL,3}]
				ELSE
					PRINTFORMC ブラジャーを外す[{LOCAL,3}]
				ENDIF
			ELSEIF LOCAL == 203
				LOCALS = パンティ
				IF CFLAG:うふふ == 3
					PRINTFORMC %LOCALS%を脱ぐ[{LOCAL,3}]
				ELSE
					PRINTFORMC %LOCALS%を脱がす[{LOCAL,3}]
				ENDIF
			ELSEIF LOCAL == 350
				;ベッドがない
				IF !BEDROOM(CFLAG:PLAYER:現在位置)
					LOCALS = 抱き寄せる
				ELSE
					LOCALS = 押し倒す
				ENDIF
				SIF GET_TARGETNUM() > 1
					LOCALS = まとめて%LOCALS%
				PRINTFORMC %LOCALS%[{LOCAL,3}]
			ELSEIF LOCAL == 403 && REST_IsRestRoom(CFLAG:MASTER:現在位置)
				PRINTFORMC 用を足す[{LOCAL,3}]
			ELSEIF LOCAL == 403 && BATHROOM(CFLAG:MASTER:現在位置)
				PRINTFORMC お風呂でくつろぐ[{LOCAL,3}]
			ELSEIF STRLENS(TRAINNAME:LOCAL)
				PRINTFORMC %TRAINNAME:LOCAL%[{LOCAL,3}]
			ENDIF
		ENDIF
	NEXT
	SIF !TFLAG:100
		GOTO SKIP
	PRINTL
	PRINTC 履歴表示[800]
	PRINTC 汚れ表示[801]
	SIF GET_TARGETNUM() > 1
		PRINTC 相手を変える[802]
	PRINTL
	PRINTC 能力表示[803]
	PRINTC 能力表示(マスター)[804]
	PRINTC コマンドフィルタ[809]
	PRINTL
	IF CFLAG:うふふ
		SIF EQUIP:PLAYER:0
			PRINTC 服を脱ぐ[820]
		IF CFLAG:うふふ == 2
			PRINTC 抜け出す[999]
		ELSEIF CFLAG:うふふ == 3
			PRINTC 自慰終了[999]
		ELSE
			PRINTC 逢引終了[999]
		ENDIF
	ENDIF
	$SKIP
	IF PREVCOM >= 0
		PRINTL 
		PRINT ＜前回調教コマンド:
		PRINTS STR:0
		SIF TFLAG:150
			PRINT (助手)
		PRINTL ＞
	ENDIF

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@USERCOM
	IF RESULT >= 0 && RESULT <= 700
		IF RESULT == 351
			CALL COM_ABLE351
			SIF !RESULT
				RETURN 0
			PRINTL 連れ出す/離れる
			STR:0 = 連れ出す/離れる
			CALL COM351
			RETURN RESULT
		ENDIF
		SIF TRAINNAME:RESULT == ""
			RETURN 0
		SELECTCOM = RESULT
		TFLAG:3 = SELECTCOM
		TRYCALLFORM COM_ABLE{SELECTCOM}
		SIF RESULT == 0
			RETURN 0
		RESULT = 1
		TRYCALLFORM CAN_COM{SELECTCOM}(1)
		IF RESULT == 0
			TRYCALLFORM CAN_COM{SELECTCOM}
			RETURN 0
		ENDIF
		DOTRAIN 999
	ELSEIF RESULT >= 701 && RESULT <= 799 && CHARANUM - 1 > RESULT - 700 && CFLAG:(RESULT - 700):同室
		TFLAG:104 = RESULT - 700
		RETURN 1
	ELSEIF RESULT == 800
		CALL SHOW_EQUIP
		RETURN 1
	ELSEIF RESULT == 801
		CALL STAIN_INFO
		RETURN 1
	ELSEIF RESULT == 802
		CALL TARGET_CHANGE
		RETURN 1
	ELSEIF RESULT == 803
		CALL PRINT_STATE(TARGET,1)
		WAIT
		RETURN 1
	ELSEIF RESULT == 804
		CALL PRINT_STATE(MASTER)
		WAIT
		RETURN 1
	ELSEIF RESULT == 809
		CALL OPTION_COMMAND_FILTER
	ELSEIF RESULT == 820 && CFLAG:うふふ && EQUIP:PLAYER:0
		EQUIP:PLAYER:0 = 0
		CALL CLOTHES_SETTING_TRAIN(PLAYER)
		RETURN 1
	ELSEIF RESULT == 888
		BEGIN AFTERTRAIN
	ELSEIF RESULT == 999 && CFLAG:うふふ
		;なんらかの不具合でTARGET:1があなたになった場合の救済措置として条件を追加
		IF TARGET:1 != 0
			IF CFLAG:(TARGET:1):うふふ == 2 && BASE:(TARGET:1):満足 < MAXBASE:(TARGET:1):満足
				PRINTFORMW %CALLNAME:(TARGET:1)%が離してくれない…
				RETURN 1
			ENDIF
		ENDIF
		FOR LOCAL,0,CHARANUM
			CFLAG:LOCAL:うふふ = 0
		NEXT
		CALL TOUCH_SET(0,0,0,1)
		RETURN 1
	ENDIF
	RETURN 0

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@TARGET_CHANGE
	PRINTFORML %CALLNAME:TARGET%の相手をしています
	PRINTL [0] - 戻る
	FOR LOCAL,1,CHARANUM
		SIF CFLAG:LOCAL:同室
			PRINTFORML [{LOCAL}] - %CALLNAME:LOCAL%
	NEXT
	INPUT
	IF RESULT <= 0 || RESULT >= CHARANUM
		RETURN 0
	ELSEIF CFLAG:RESULT:同室
		TFLAG:104 = RESULT
	ENDIF

;-------------------------------------------------------------------------------
;FIXME:関数の説明を書いてください
;@return 1:xxx,0:xxx
@SHOW_EQUIP
	WAIT
